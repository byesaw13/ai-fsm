meta:
  project: ai-fsm
  mode: autonomous
  quality_gate: pnpm gate

epics:
  - id: E1
    name: Foundation
    phase: 1
    tasks:
      - id: T1-1
        title: Implement email/password auth and session handling
        status: pending
        acceptance:
          - owner/admin/tech can sign in
          - unauthorized routes redirect to login
      - id: T1-2
        title: Implement jobs CRUD with status transitions
        status: pending
        acceptance:
          - create/read/update jobs
          - status transitions validated
      - id: T1-3
        title: Implement visits scheduling and assignment
        status: pending
        acceptance:
          - assign tech to visit
          - complete visit with notes

  - id: E2
    name: Commercial Flow
    phase: 2
    tasks:
      - id: T2-1
        title: Implement estimates CRUD and lifecycle
        status: pending
        acceptance:
          - estimate statuses enforced
      - id: T2-2
        title: Implement estimate-to-invoice conversion
        status: pending
        acceptance:
          - conversion creates immutable snapshot line items
      - id: T2-3
        title: Implement manual payment recording
        status: pending
        acceptance:
          - invoice paid/partial updates automatically

  - id: E3
    name: Automations + Hardening
    phase: 3
    tasks:
      - id: T3-1
        title: Add visit reminder automation
        status: pending
        acceptance:
          - reminders generated before scheduled visits
      - id: T3-2
        title: Add overdue invoice follow-up automation
        status: pending
        acceptance:
          - follow-up events generated by aging rule
      - id: T3-3
        title: Pi deployment and backup runbook
        status: pending
        acceptance:
          - deploy on arm64 compose profile
          - backup/restore validated
